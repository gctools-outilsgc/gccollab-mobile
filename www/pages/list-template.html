<template>
    <div class="page navbar-fixed with-subnavbar">
        <div class="navbar">
            <div class="navbar-inner">
                <div id="{{page}}-navbar-inner" class="navbar-inner" role="navigation" data-translate-target="aria-label" data-translate="navigation-bar">
                    {{navbar}}
                </div>
                {{#js_if "this.tabs.length != 1" }}
                <div class="subnavbar" role="navigation" data-translate-target="aria-label">
                    <div class="subnavbar-inner">
                        <div class="segmented">
                            {{#each tabs}}
                            <a href="#tab-{{this.id}}" class="button {{#if @first}}tab-link-active{{/if}} tab-link" data-translate="{{this.name}}"></a>
                            {{/each}}
                        </div>
                    </div>
                </div>
                {{/js_if}}
            </div>
        </div>
        <div class="toolbar toolbar-bottom-md" role="navigation" data-translate-target="aria-label" data-translate="toolbar">
            <div class="toolbar-inner">
                <div class="left sliding"><a href="#" class="link back" aria-label="Back Button"><i class="far fa-arrow-alt-circle-left fa-2x"></i></a></div>
                <p><a href="#" data-popup=".my-popup5" class="popup-open">Open Popup</a></p>
                <div class="right sliding">{{this.action}}{{this.filter}}</div>
            </div>
        </div>

        <div class="page with-subnavbar" style="overflow-x: hidden;">
            <div class="tabs">
                {{#each tabs}}
                <div id="tab-{{this.id}}" class="page-content tab {{#if @first}}tab-active{{/if}}">
                    {{this.header}}
                    {{#js_if "this.type == 'card'"}}<div id="content-{{this.id}}" class='list cards-list'></div>{{/js_if}}
                    {{#js_if "this.type == 'item'"}}<div class="list media-list"><ul id="content-{{this.id}}"></ul></div>{{/js_if}}
                    <div class="block">
                        <div class="row">
                            <a id="more-{{this.id}}" class="col button button-big button-fill" data-translate="view-more">VIEW MORE</a>
                        </div>
                    </div>
                </div>
                {{/each}}
            </div>
        </div>
        {{#js_if "this.page === 'home'"}}
        <div class="popover popover-actions-{{page}}">
            <div class="popover-inner">
                <div class="list">
                    <ul id="popover-actions-{{page}}">
                        <li><a href="#" onclick="GCTrequests.PostWirePost();" class="list-button item-link popover-close"><i class="fas fa-rss"> <span data-translate="create-wire"></span></i></a></li>
                        <li><a href="#" onclick="GCTrequests.PostBlogPost();" class="list-button item-link popover-close"><i class="fas fa-edit"> <span data-translate="post-blog"></span></i></a></li>
                        <li><a class="list-button item-link popover-close" href="#" data-translate="close"></a></li>
                    </ul>
                </div>
            </div>
        </div>
        {{/js_if}}
        {{#js_if "this.filters"}}
        <div class="popup my-popup5">
            <div class="view">
                <div class="page">
                    <div class="navbar">
                        <div class="navbar-inner">
                            <div class="title">Popup</div>
                            <div class="right">
                                <!-- Link to close popup -->
                                <a class="link popup-close">Close</a>
                            </div>
                        </div>
                    </div>
                    <div class="page-content">
                        ...
                    </div>
                </div>
            </div>
            ...
        </div>
        {{/js_if}}
    </div>
</template>
<style>
    p {
        margin: 10px 0;
    }
</style>
<script>
    return {
        // Lifecycle Hooks
        beforeCreate() {
            //console.log('componentBeforeCreate', this)
        },
        created() {
            //console.log('componentCreated', this)
        },
        beforeMount() {
            //console.log('componentBeforeMount', this)
        },
        mounted() {
            //console.log('componentMounted', this);
        },
        beforeDestroy() {
            //console.log('componentBeforeDestroy', this);
        },
        destroyed() {
            //console.log('componentDestroyed', this);
        },
        // Component Data
        data: function () {
            
            // Must return an object
            
            return {
            }
        },
        // Component Methods
        methods: {
            openAlert: function () {
                var self = this;
                self.$app.dialog.alert('Hello World');
            },
        },
        // Page Events
        on: {
            pageMounted: function (e, page) {
                //console.log('pageMounted', page);
            },
            pageInit: function (e, page) {
                console.log('pageInit', page);
                var tabs = this.tabs;
                tabs[0].request(tabs[0]); //load first tab, which is active tab
                tabs.forEach(function (tab) {
                    //More Button
                    $$('#more-' + tab.id).on('click', function (e) {
                        $('#focus-' + tab.id).remove();
                        tab.request(tab);
                    });
                    //Tab Show
                    $$('#tab-' + tab.id).on('tab:show', function (e) {
                        if (!tab.loaded) {
                            tab.request(tab);
                        }
                    });
                });
                //Refresh Button - All
                $$('#refresh-' + this.page).on('click', function (e) {
                    tabs.forEach(function (tab) {
                        GCTtabs.TabReset(tab);
                    });
                });
            },
            pageBeforeIn: function (e, page) {
                //console.log('pageBeforeIn', page);
            },
            pageAfterIn: function (e, page) {
                //console.log('pageAfterIn', page);
            },
            pageBeforeOut: function (e, page) {
                //console.log('pageBeforeOut', page);
            },
            pageAfterOut: function (e, page) {
                //console.log('pageAfterOut', page);
            },
            pageBeforeRemove: function (e, page) {
                //console.log('pageBeforeRemove', page);
            },
        }
    }
</script>